$(document).on("turbolinks:load",function(){function a(){var a=$("#date"),t=$("#splendingdate"),e=$("h1"),l=a.val(),s=a.data("ajax-path")+"&"+a.attr("name")+"="+l+"&"+t.attr("name")+"="+t.val();e.text(e.data("text")+" "+l),$.ajax({url:s,type:"POST",dataType:"script"})}function t(a,t){var e=$("#table_menu_children_categories #children_cost_"+a+"_"+t),l=floatValue($("#table_menu_children_categories #cost_"+t).html()),s=$("#table_menu_children_categories #children_diff_"+a+"_"+t),i=floatValue($("#table_menu_children_categories #count_all_"+a+"_"+t).val()),n=0==i?0:Math.round(floatValue(e.data("sum"))/i*100)/100,o=n-l;e.html(f2_to_s(n)),s.html(f2_to_s(o)).removeClass("positive negative").addClass(o>0?"positive":"negative")}function e(){if($("h1").hasClass("icon_show")||$("h2:nth-of-type(1)").hasClass("icon_show")){$("#table_menu_products").removeClass("min_height");var a=$("#table_menu_products .table").height(),t=$(window).height()-$("#table_menu_products").position().top-l;a>t&&$("#table_menu_products").height(t)}else $("#table_menu_products").addClass("min_height")}var l=getScrollbarWidth();$("#menu_requirement_products").length&&($("#main_menu li").removeClass("active"),$("#mm_menu_requirements").addClass("active"),$("#table_menu_products table").tableHeadFixer({left:2}),$("#send_sap, #send_saf").click(function(){$("#dialog_wait").dialog("open"),$.ajax({url:$(this).data("ajax-path"),type:"POST",dataType:"script"})}),$("#date, #splendingdate").datepicker({onSelect:function(){var t=$(this);t.data("old-value")!=t.val()&&a()}}),$("#table_menu_children_categories input").focus(function(){var a=$(this);a.data("old-value",a.val()).select(),$("#table_menu_children_categories tr").removeClass("selected"),a.parents("tr").addClass("selected")}),$("#table_menu_children_categories input").blur(function(){var a=$(this),t=a.data("ajax-blur");t&&(a.data("ajax-blur",""),$.ajax({url:t,type:"POST",dataType:"script"}))}),$("#table_menu_children_categories input").change(function(){var a=$(this),e=floatValue(a.data("old-value")),l=Math.trunc(floatValue(a.val()));if(a.val(IntToString(l)),e!=l){a.data("old-value",l);var s=a.attr("name").split("_"),i=$("#table_menu_children_categories #"+s[0]+"_"+s[1]+"_"+s[2]+"_total");i.html(IntToString(floatValue(i.html())-e+l)),a.data("ajax-blur",a.data("ajax-path")+"&"+s[0]+"_"+s[1]+"_"+s[2]+"="+l)}(s[1]="all")&&t(s[2],s[3])}),$("#table_menu_products input").focus(function(){var a=$(this);a.data("old-value",a.val()).select(),$("#table_menu_products tr").removeClass("selected"),a.parents("tr").addClass("selected")}),$("#table_menu_products input").blur(function(){var a=$(this),t=a.data("ajax-blur");t&&(a.data("ajax-blur",""),$.ajax({url:t,type:"POST",dataType:"script"}))}),$("#table_menu_products input").change(function(){var a=$(this),e=floatValue(a.data("old-value")),l=Math.trunc(1e3*floatValue(a.val()))/1e3;if(a.val(f3_to_s(l)),e!=l){a.data("old-value",l);var s=a.attr("name").split("_"),i=s[1],n=a,o=l,_=e,u=l-e;switch(i){case"diff":i="fact";var n=$("#table_menu_products #"+s[0]+"_"+i+"_"+s[2]+"_"+s[3]+"_"+s[4]);_=floatValue(n.val()),o=_-e+l,n.val(f3_to_s(o)).data("old-value",o),a.removeClass("positive").removeClass("positive").addClass(l>0?"positive":"negative");break;case"fact":var r=$("#table_menu_products #"+s[0]+"_diff_"+s[2]+"_"+s[3]+"_"+s[4]),d=floatValue(r.val())-e+l;r.val(f3_to_s(d)).removeClass("positive negative").removeClass("positive").addClass(u>0?"positive":"negative")}var c=$("#table_menu_products #"+s[0]+"_"+i+"_all_"+s[2]);c.html(f3_to_s(floatValue(c.html())+u));var h=Math.round(o*floatValue($("#table_menu_products #price_"+s[2]).html())*100)/100,v=h-floatValue(n.data("sum"));n.data("sum",f2_to_s(h));var m=$("#table_menu_children_categories #children_cost_"+i+"_"+s[3]);m.data("sum",f2_to_s(floatValue(m.data("sum"))+v)),t(i,s[3]),a.data("ajax-blur",n.data("ajax-path")+"&"+s[0]+"_"+i+"="+o)}}),$("h2:nth-of-type(1)").click(function(){$(this).toggleClass("icon_hide icon_show"),$("#table_menu_children_categories").slideToggle(function(){e()})}),$("h1").click(function(){$(this).toggleClass("icon_hide icon_show"),$("#panel_main").slideToggle(function(){e()})}))});