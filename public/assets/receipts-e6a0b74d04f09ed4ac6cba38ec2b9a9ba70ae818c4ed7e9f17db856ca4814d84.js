$(document).on("turbolinks:load",function(){function e(){var e=$("#date_start"),t=$("#date_end"),a=$("#supplier_name"),r=($("#contact_number"),e.val()),s=t.val(),o=a.data("value");sessionStorage.receipts_date_start=r,sessionStorage.receipts_date_end=s,sessionStorage.receipts_supplier_name=a.val(),sessionStorage.receipts_supplier_name_value=o;var l=e.data("ajax-path")+"?"+e.attr("name")+"="+r+"&"+t.attr("name")+"="+s+"&"+a.data("ajax-param")+"="+o;$.ajax({url:l,type:"GET",dataType:"script"})}$("#receipts").length&&($("#main_menu li").removeClass("active"),$("#mm_receipts").addClass("active"),sessionStorage.receipts_date_start&&$("#date_start").val(sessionStorage.receipts_date_start),sessionStorage.receipts_date_end&&$("#date_end").val(sessionStorage.receipts_date_end),sessionStorage.receipts_supplier_name&&$("#supplier_name").val(sessionStorage.receipts_supplier_name),sessionStorage.receipts_supplier_name_value&&$("#supplier_name").data("value",sessionStorage.receipts_supplier_name_value),$("#dialog_delete").data("delete","deleteReceipt();"),$("#dialog_delete").data("un-delete","unDeleteReceipt();"),e(),selectSupplierOrder=function(){var e=1;sessionStorage.receipts_table_supplier_orders_scroll&&$("#table_supplier_orders").scrollTop(sessionStorage.receipts_table_supplier_orders_scroll),sessionStorage.receipts_table_supplier_orders_row&&(e=sessionStorage.receipts_table_supplier_orders_row),$("#table_supplier_orders tbody tr.selected").removeClass("selected"),$("#table_supplier_orders tbody tr:nth-of-type( "+e+" )").addClass("selected"),filter\u0421ontractNumbers()},emptySupplierOrder=function(){var e=$(".clmn:nth-of-type(2) h1");sessionStorage.removeItem("receipts_table_supplier_orders_row"),sessionStorage.removeItem("receipts_table_supplier_orders_scroll"),e.text(e.data("text")),empty\u0421ontractNumber()},filter\u0421ontractNumbers=function(){var e=$("#table_supplier_orders tbody tr.selected"),t=$(".clmn:nth-of-type(2) h1");t.text(t.data("text")+" "+e.children("td:nth-of-type(2)").html()),$.ajax({url:e.data("ajax-path"),type:"GET",dataType:"script"})},select\u0421ontractNumber=function(){var e=$("#contract_number"),t=$("#create_receipt");sessionStorage.receipts_contract_number?(e.val(sessionStorage.receipts_contract_number),e.removeClass("placeholder"),t.prop("disabled",!1)):(e.addClass("placeholder"),t.prop("disabled",!0)),filterTableReceipts()},empty\u0421ontractNumber=function(){sessionStorage.removeItem("receipts_contract_number"),sessionStorage.removeItem("receipts_table_receipts_scroll"),sessionStorage.removeItem("receipts_table_receipts_orders_row"),$("#contract_number").val("").prop("disabled",!0),$("#table_receipts").empty()},filterTableReceipts=function(){var e=$("#contract_number"),t=e.data("ajax-path")+$("#table_supplier_orders tbody tr.selected").data("id")+"&"+e.attr("name")+"="+e.val();$.ajax({url:t,type:"GET",dataType:"script"})},deleteReceipt=function(){$.ajax({url:$("tr.delete .btn_del").data("ajax-path"),type:"DELETE",dataType:"script"}),1==$("tbody").children().length?$("#table_receipts").empty():$("tr.delete").remove()},unDeleteReceipt=function(){$("tr.delete").removeClass("delete")},$("#date_start").datepicker({onSelect:function(){var t=$(this),a=t.val();if(t.data("old-value")!=a){var r=$("#date_end");a>r.val()&&r.val(a),e()}}}),$("#date_end").datepicker({onSelect:function(){var t=$(this),a=$(this).val();if(t.data("old-value")!=a){var r=$("#date_start");a<r.val()&&r.val(a),e()}}}),$("#create_receipt").click(function(){var e=$(this);$("#dialog_wait").dialog("open");var t=$("#contract_number"),a=e.data("ajax-path")+$("#table_supplier_orders tbody tr.selected").data("id")+"&"+t.attr("name")+"="+t.val();$.ajax({url:a,type:"POST",dataType:"script"})}),$(document).on("click","#table_supplier_orders tbody  tr",function(){var e=$(this);e.hasClass("selected")||(sessionStorage.receipts_table_supplier_orders_row=e.index()+1,sessionStorage.receipts_table_supplier_orders_scroll=$("#table_supplier_orders").scrollTop(),sessionStorage.removeItem("receipts_contract_number"),selectSupplierOrder())}),$("#supplier_name").autocomplete({source:$("#supplier_name").data("ajax-source"),select:function(t,a){var r=$(this);return r.data("value",a.item.value),r.val(a.item.label),e(),!1}}),$("#supplier_name").keyup(function(){var t=$(this);t.val()||(t.data("value",""),e())}),$(document).on("change","#contract_number",function(){var e=$(this),t=e.val();e.val()?sessionStorage.receipts_contract_number=t:sessionStorage.removeItem("receipts_contract_number"),select\u0421ontractNumber()}),$(document).on("click","td .btn_del",function(){$(this).parents("tr").addClass("delete"),$("#dialog_delete").dialog("open")}),$(document).on("click","td .btn_view, td .btn_edit",function(){var e=$(this).parents("tr");sessionStorage.receipts_table_receipts_orders_row=e.index()+1,sessionStorage.receipts_table_receipts_scroll=$("#table_receipts").scrollTop(),window.location.replace(e.data("path"))}))});