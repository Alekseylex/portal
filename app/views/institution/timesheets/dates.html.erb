<!-- Отображение документа табеля -->

<%= content_tag :div, id: :timesheet_dates do %>

  <%= content_tag :h1, '', data: { id: @timesheet.id, text: "Табель № #{ @timesheet.number } від" } %>

  <%= content_tag :div, id: :panel_main do %>
    <%= content_tag :div, class: :panel do %>
      <%= button_tag '', class: :btn_send, id: :send_sa, disabled: ( @timesheet.date_sa || !@timesheet.number ), data: {
        ajax_path: "#{ institution_timesheets_send_sa_path }?id=#{ @timesheet.id }" } %>
      <%= button_tag '', class: ( @timesheet.date_sa ? :btn_exit : :btn_save ),
                     onclick: "location.href='#{ institution_timesheets_index_path }'" %>
      <% if @timesheet.date_sa %>
        <%= label_tag '', 'Надіслано:' %>
        <%= label_tag :number, 'документ' %>
        <%= content_tag :nav, class: :icon_number do text_field_tag( :number_sap, @timesheet.number_sa, disabled: true ) end %>
        <%= label_tag :date, 'від' %>
        <%= content_tag :nav, class: :icon_сalendar do text_field_tag( :date, date_str( @timesheet.date_sa ), disabled: true ) end %>
      <% end %>
    <% end %>

    <%= content_tag :div, class: :panel do %>
      <%= label_tag :number, 'Табель № ' %>
      <%= content_tag :nav, class: :icon_number do text_field_tag( :number, @timesheet.number, disabled: true ) end %>

      <%= label_tag :date, 'від' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date, date_str( @timesheet.date ), disabled: @timesheet.date_sa, readonly: true,
            data: { ajax_path: "#{institution_timesheets_update_path}?id=#{@timesheet.id}" } %>
      <% end %>

      <%= label_tag :date_eb, 'З' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date_eb, date_str( @timesheet.date_eb ), disabled: @timesheet.number, readonly: true %>
      <% end %>

      <%= label_tag :date_ee, 'ПО' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date_ee, date_str( @timesheet.date_ee ), disabled: @timesheet.number, readonly: true %>
      <% end %>

      <% if @timesheet.number.nil? %>
        <%= button_tag '', class: :btn_create, id: :create, disabled: @timesheet.number,
                       data: { ajax_path: institution_timesheets_create_path } %>
      <% else %>
        <%= content_tag :nav, '', class: :icon_filter do %>
          <%= select_tag :group_timesheet, options_for_select( @group_timesheet ), prompt: 'Категорія / Група',
              data: { param_name: :field, param_id: :field_id, ajax_path:
                "#{ institution_timesheets_ajax_filter_timesheet_dates_path }?id=#{ @timesheet.id }&" } %>
        <% end %>
      <% end %>

    <% end %>
  <% end %>

  <%= content_tag :ul, id: :reasons_absences, style: 'display: none;' do %>
    <% @reasons_absences.each_with_index do | v, i | %>
      <% next_v = @reasons_absences[ @reasons_absences.last == v ? 0 : i + 1 ] %>
      <%= content_tag :li, v[ 2 ], id: "reasons_absence_#{ v[ 0 ] }",
                      data: { id: v[ 0 ], next_id: next_v[ 0 ], next_val: next_v[ 2 ]  } %>
    <% end %>
  <% end %>

  <%= content_tag :div, '', id: :table_timesheet_dates %>
<% end %>