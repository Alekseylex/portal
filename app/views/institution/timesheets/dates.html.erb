<!-- Отображение документа табеля -->

<%= content_tag :div, id: :timesheet_dates do %>

  <%= content_tag :h1, '', data: { text: "Табель № #{ @timesheet.number } від" } %>

  <%= content_tag :div, id: :panel_main do %>
    <%= content_tag :div, class: :panel do %>
      <%= button_tag '', class: :btn_send, id: :send_sa, disabled: ( @timesheet.date_sa || !@timesheet.number ), data: {
        ajax_path: "#{ institution_timesheets_send_sa_path }?id=#{ @timesheet.id }" } %>
      <%= button_tag '', class: ( @timesheet.date_sa ? :btn_exit : :btn_save ),
                     onclick: "location.href='#{ institution_timesheets_index_path }'" %>
      <% if @timesheet.date_sa %>
        <%= label_tag '', 'Надіслано:' %>
        <%= label_tag :number, 'документ' %>
        <%= content_tag :nav, class: :icon_number do text_field_tag( :number_sap, @timesheet.number_sa, disabled: true ) end %>
        <%= label_tag :date, 'від' %>
        <%= content_tag :nav, class: :icon_сalendar do text_field_tag( :date, date_str( @timesheet.date_sa ), disabled: true ) end %>
      <% end %>
    <% end %>

    <%= content_tag :div, class: :panel do %>
      <%= label_tag :number, 'Табель № ' %>
      <%= content_tag :nav, class: :icon_number do text_field_tag( :number, @timesheet.number, disabled: true ) end %>

      <%= label_tag :date, 'від' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date, date_str( @timesheet.date ), disabled: @timesheet.date_sa, readonly: true,
            data: { ajax_path: "#{institution_timesheets_update_path}?id=#{@timesheet.id}" } %>
      <% end %>

      <%= label_tag :date_eb, 'З' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date_eb, date_str( @timesheet.date_eb ), disabled: @timesheet.number, readonly: true %>
      <% end %>

      <%= label_tag :date_ee, 'ПО' %>
      <%= content_tag :nav, class: :icon_сalendar do %>
        <%= text_field_tag :date_ee, date_str( @timesheet.date_ee ), disabled: @timesheet.number, readonly: true %>
      <% end %>

      <%= button_tag '', class: :btn_create, id: :create, disabled: @timesheet.number,
                     data: { ajax_path: institution_timesheets_create_path } %>

    <% end %>
  <% end %>

  <% if @timesheet_dates.present? %>

    <%= content_tag :div, id: :table_timesheet_dates do %>
      <%= content_tag :table, class: :table  do %>

        <% for i in 0..@date_range[ :count ] do %>
          <%= content_tag :col %>
        <% end %>

        <%= content_tag :thead do %>
          <%= content_tag :tr do %>
            <%= content_tag :th, 'Дитина' %>
            <% ( @timesheet.date_vb..@timesheet.date_ve ).each do | value | %>
              <%= content_tag :th, "#{value.day} #{short_day_of_week( value.wday )}" %>
            <% end %>

          <% end %>
        <% end %>

        <%= content_tag :tbody do %>
          <% date = '' %>
          <% @timesheet_dates.each do | timesheet_dates | %>

            <%= content_tag :tr do %>
              <%= content_tag :td, timesheet_dates.child_name %>
              <% for i in 1..@date_range[ :count ] do %>
                <% value = timesheet_dates["d_#{i}"].split('_') %>
                <%= content_tag :td, value[2]  %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>

    <% end %>
  <% end %>

<% end %>